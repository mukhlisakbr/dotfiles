{;; ======================================================================
 ;;                            APPLICATIONS
 ;; ======================================================================
 :applications {:vscode ["^com\\.microsoft\\.VSCode$"]
                :chrome ["^com\\.google\\.Chrome$"]}

 ;; ======================================================================
 ;;                             TEMPLATES
 ;; ======================================================================
 :templates {:open "open -a '%s'"}

 ;; ======================================================================
 ;;                         MAIN CONFIGURATION
 ;; ======================================================================
 :main [;; ----------------------------------------------------------------------
        ;; 1. LAYER DEFINITIONS
        ;; ----------------------------------------------------------------------
        {:des "Layer: Hyper Mode (Caps Lock)"
         :rules [;; Hold Caps Lock to activate "hyper-mode", tap for Escape.
                 [:caps_lock ["hyper-mode" 1] nil {:afterup ["hyper-mode" 0]
                                                   :alone :escape}]]}

        ;; ----------------------------------------------------------------------
        ;; 2. HYPER MODE SUB-LAYER TRIGGERS
        ;; ----------------------------------------------------------------------
        {:des "Sub-layer Triggers: App Launcher & Window Management"
         :rules [:hyper-mode
                 ;; Hold ";" to activate app launcher layer
                 [:semicolon ["app-launcher" 1] nil {:afterup ["app-launcher" 0]}]
                 ;; Hold 'w' to activate window management layer
                 [:w ["window-management" 1] nil {:afterup ["window-management" 0]}]]}

        ;; ----------------------------------------------------------------------
        ;; 3. HYPER MODE RULES
        ;; ----------------------------------------------------------------------
        {:des "Rules: Hyper Mode (General)"
         :rules [[:condi :hyper-mode :!app-launcher :!window-management]
                 ;; --- VIM-STYLE NAVIGATION ---
                 [:h :left_arrow]         ;; Hyper + h -> Left
                 [:j :down_arrow]         ;; Hyper + j -> Down
                 [:k :up_arrow]           ;; Hyper + k -> Up
                 [:l :right_arrow]        ;; Hyper + l -> Right

                 ;; --- TAB NAVIGATION ---
                 [:close_bracket :!CSclose_bracket] ;; Hyper + ] -> Next Tab (Cmd+Shift+])
                 [:open_bracket :!CSopen_bracket]   ;; Hyper + [ -> Previous Tab (Cmd+Shift+[)

                 ;; --- SHELL & TEXT COMMANDS ---
                 [:c :!Tc]                ;; Hyper + c -> Interrupt (Ctrl+C)
                 [:r :!Tr]                ;; Hyper + r -> Reverse Search (Ctrl+R)
                 [:v :!Tv]                ;; Hyper + v -> Visual Block Mode (Ctrl+V)
                 ]}

        ;; ----------------------------------------------------------------------
        ;; 4. APPLICATION-SPECIFIC HYPER MODE RULES
        ;; ----------------------------------------------------------------------
        {:des "Rules: Hyper Mode (VS Code)"
         :rules [[:condi :hyper-mode :vscode :!app-launcher :!window-management]
                 [:t :!Tgrave_accent_and_tilde]    ;; Hyper + t -> Toggle Terminal (Ctrl+`)
                 [:s :!TSg]                        ;; Hyper + s -> Toggle Source Control (Ctrl+Shift+G)
                 [:e :!CSe]                        ;; Hyper + e -> Toggle Explorer (Cmd+Shift+E)
                 [:x :!CSx]                        ;; Hyper + x -> Toggle Extensions (Cmd+Shift+X)
                 [:f :!Cp]                         ;; Hyper + f -> Go to File (Cmd+P)
                 [:g :!Ct]                         ;; Hyper + g -> Go to Symbol in Workspace (Cmd+T)
                 [:o :!CSo]                        ;; Hyper + o -> Go to Symbol in File (Cmd+Shift+O)
                 [:d :f12]                         ;; Hyper + d -> Go to Definition (F12)
                 [:i :!SCa]                        ;; Hyper + i -> Kilocode AI Agent (Shift+Cmd+A)
                 [:p :!CSp]                        ;; Hyper + p -> Show Command Palette (Cmd+Shift+P)
                 [:spacebar :!Tspacebar]           ;; Hyper + Space -> Trigger Autocomplete (Ctrl+Space)
                 ]}

        {:des "Rules: Hyper Mode (Chrome)"
         :rules [[:condi :hyper-mode :chrome :!app-launcher :!window-management]
                 [:t :!CSa]                        ;; Hyper + t -> Search Tabs (Cmd+Shift+A)
                 ]}

        ;; ----------------------------------------------------------------------
        ;; 5. SUB-LAYER RULES
        ;; ----------------------------------------------------------------------
        {:des "Rules: App Launcher"
         :rules [:app-launcher
                 [:a [:open "ChatGPT"]]              ;; Hyper + ; + a -> ChatGPT
                 [:b [:open "Google Chrome"]]        ;; Hyper + ; + b -> Chrome
                 [:c [:open "WhatsApp"]]             ;; Hyper + ; + c -> WhatsApp
                 [:e [:open "Visual Studio Code"]]   ;; Hyper + ; + e -> VS Code
                 [:f [:open "Finder"]]               ;; Hyper + ; + f -> Finder
                 [:m [:open "Spotify"]]              ;; Hyper + ; + m -> Spotify
                 [:t [:open "iTerm"]]                ;; Hyper + ; + t -> iTerm
                 ]}

        {:des "Rules: Window Management"
         :rules [:window-management
                 [:h :!TOleft_arrow]                      ;; Hyper + w + h -> Tile Left (Ctrl+Option+Left)
                 [:l :!TOright_arrow]                     ;; Hyper + w + l -> Tile Right (Ctrl+Option+Right)
                 [:return_or_enter :!TOreturn_or_enter]   ;; Hyper + w + enter -> Maximize (Ctrl+Option+Enter)
                 ]}

        ;; ----------------------------------------------------------------------
        ;; 6. GLOBAL REMAPS
        ;; ----------------------------------------------------------------------
        {:des "Global: Remaps"
         :rules [;; Remap Escape to Caps Lock
                 [:escape :caps_lock]]}]}
